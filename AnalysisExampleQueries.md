# Example Queries

Funnels for mission progression will also be created

```sql
SELECT GTANSWERTREATMENTGROUP, COUNT(DISTINCT USERID)
FROM EVENTS
WHERE EVENTNAME = 'gameTuneAnswerUsed'
AND GTANSWERNAME = 'difficulty_ramp'
GROUP BY GTANSWERTREATMENTGROUP
```

```sql
SELECT GTANSWERVALUE, COUNT(DISTINCT USERID)
FROM EVENTS
WHERE EVENTNAME = 'gameTuneAnswerUsed'
AND GTANSWERNAME = 'difficulty_ramp'
GROUP BY GTANSWERVALUE
```

Pivot this table for visualisation:

```sql
SELECT EVENT_DATE,
        GTANSWERVALUE,
        COUNT(DISTINCT USER_ID) AS DAU
FROM FACT_USER_SESSIONS_DAY
WHERE EVENTNAME = 'gameTuneAnswerUsed'
AND GTANSWERNAME = 'difficulty_ramp'
GROUP BY EVENT_DATE, GTANSWERVALUE
ORDER BY EVENT_DATE
```

Will need to test this following one works

```sql
WITH FIRST_PASS AS
  (SELECT DATEDIFF(DAY, PLAYER_START_DATE, EVENT_DATE) AS DAYS_SINCE_INSTALL,
          ROUND(COUNT(DISTINCT USER_ID)/MAX(COUNT(DISTINCT USER_ID)) OVER (PARTITION BY DAYS_SINCE_INSTALL)*100., 2.) AS "% RETENTION",
          GTANSWER
   FROM FACT_USER_SESSIONS_DAY FUSD
   JOIN (SELECT USERID, FIRST_VALUE(GTANSWERVALUE) OVER (PARTITION BY USERID ORDER BY EVENTDATE ASC) AS GTANSWER
         FROM EVENTS
         WHERE EVENTNAME = 'gameTuneAnswerUsed'
         AND GTANSWERNAME = 'difficulty_ramp')
   ON USER_ID = USERID
   WHERE DAYS_SINCE_INSTALL >= 0
   GROUP BY DAYS_SINCE_INSTALL,
            GTANSWER)
            
SELECT *
FROM FIRST_PASS
ORDER BY DAYS_SINCE_INSTALL
```
